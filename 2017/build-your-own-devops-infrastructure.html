<!DOCTYPE HTML>
<!--
	Read Only by HTML5 UP
	html5up.net | @n33co
	Free for personal and commercial use under the CCA 3.0 license (html5up.net/license)

	Modified by Alex Fernández
	alexfernandez.github.io | @pinchito
-->
<html>
	<head>
		<title>Build Your Own DevOps Infrastructure</title>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1" />
		<link rel="stylesheet" href="../css/main.css" />
		<link rel="shortcut icon" href="/favicon.png" type="image/png" />
		<!--[if lte IE 8]><link rel="stylesheet" href="../css/ie8.css" /><![endif]-->
		<script>
		// Disable tracking if the opt-out cookie exists.
		var disableStr = 'ga-disable-UA-75898530-1';
		if (document.cookie.indexOf(disableStr + '=true') > -1) {
			  window[disableStr] = true;
		}
		// Opt-out function
		function gaOptout() {
			document.cookie = disableStr + '=true; expires=Thu, 31 Dec 2099 23:59:59 UTC; path=/';
			window[disableStr] = true;
		}
		(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
			(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
				m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
		})(window,document,'script','//www.google-analytics.com/analytics.js','ga');
		ga('create', 'UA-75898530-2', 'auto');
		ga('send', 'pageview');

		</script>
	</head>
	<body>

		<!-- Header -->
			<section id="header">
				<header>
					<span class="image avatar"><a href="../index.html"><img src="../pics/avatar.jpg" alt="Avatar" /></a></span>
					<h1 id="logo"><a href="../index.html">Alex Fernández</a></h1>
					<p>
					I am a developer known on Twitter as <a href="https://twitter.com/pinchito">pinchito</a>.
					</p>
					<p>
					This site uses (gasp!) cookies for gathering statistics.
					You can
						<a href="javascript:gaOptout()">disable them</a>.
					</p>
				</header>
				<!--
				<nav id="nav">
					<ul>
						<li><a href="#one" class="active">About</a></li>
						<li><a href="#two">Things I Can Do</a></li>
						<li><a href="#three">A Few Accomplishments</a></li>
						<li><a href="#four">Contact</a></li>
					</ul>
				</nav>
				<footer>
					<ul class="icons">
						<li><a href="#" class="icon fa-twitter"><span class="label">Twitter</span></a></li>
						<li><a href="#" class="icon fa-facebook"><span class="label">Facebook</span></a></li>
						<li><a href="#" class="icon fa-instagram"><span class="label">Instagram</span></a></li>
						<li><a href="#" class="icon fa-github"><span class="label">Github</span></a></li>
						<li><a href="#" class="icon fa-envelope"><span class="label">Email</span></a></li>
					</ul>
				</footer>
				-->
			</section>

		<!-- Wrapper -->
			<div id="wrapper">

				<!-- Main -->
					<div id="main">

						<!-- One -->
							<section id="one">
								<div class="container">
									<header class="major">
										<h1>Build Your Own DevOps Infrastructure</h1>
										<p>Talk for FullStack London 2017<p>
									</header>
																				<p>[](pics/build-otomo.jpg &quot;Build your own <a href="https://commons.wikimedia.org/wiki/File:FIBD2016Otomo01.jpg">Akira motorbike</a>)</p>
<h2 id="devops-infrastructure">DevOps Infrastructure</h2>
<p>Your company is using cloud services. You want to do DevOps because you think it's cool, so you install Jenkins somewhere and... What now exactly?</p>
<p>The foundational idea of DevOps is to treat infrastructure as code.</p>
<p>Come with us to <a href="https://skillsmatter.com/conferences/8264-fullstack-2017-the-conference-on-javascript-node-and-internet-of-things#program">FullStack 2017</a>, where you will learn how to build your own DevOps infrastructure. This companion post should help you make the most of the talk.</p>
<h3 id="requirements">Requirements</h3>
<p>All code uses Node.js, as befits a JavaScript event. We are using ES6, so if you are running version of Node.js 7 or earlier you will need to start it with the <code>--harmony</code> flag.</p>
<p>We use <a href="https://aws.amazon.com/">Amazon Web Services</a> in the examples, but the same infrastructure can be built for any other cloud provider, as long as they have a Node.js client.</p>
<h2 id="code-talks">Code Talks</h2>
<p>In the talk we will do a live demo to build our own simplified infrastructure. A more complete example resides in the GitHub repo <a href="https://github.com/alexfernandez/infra">infra</a>.</p>
<h3 id="email">Email</h3>
<p>We use with a couple of helper libraries, which will simplify our job. They are simple adapters for the official libraries, and will be introduced as they are needed.</p>
<p>The first helper library will simplify the task of sending an email: <a href="https://github.com/alexfernandez/infra/blob/master/lib/email.js"><code>lib/email.js</code></a>. It has a very simple interface:</p>
<pre><code>email.send(subject, text, callback)</code></pre>
<p>We have to indicate the subject and the text to send, and it will invoke the callback with an error if it fails. Internally this adapter uses the <code>emailjs</code> npm library.</p>
<h3 id="log">Log</h3>
<p>First we will start with a <a href="https://github.com/alexfernandez/infra/blob/master/lib/log.js">log library</a>.</p>
<h3 id="monitor">Monitor</h3>
<p>Next we will build a very simple <a href="https://github.com/alexfernandez/infra/blob/master/lib/monitor.js">monitor</a>. Its only task is to check if our websites are up, and to notify us otherwise.</p>
<h4 id="possible-refinements">Possible Refinements</h4>
<ul>
<li>Warn only once when the website is down.</li>
<li>Notify us when the website is up again.</li>
</ul>
<h3 id="aws">AWS</h3>
<p>The second helper library is an adapter for the official <code>aws-sdk</code> library from Amazon, which has a, let's say, somewhat quirky interface.</p>
<p><a href="https://github.com/alexfernandez/infra/blob/master/lib/aws.js"><code>lib/aws.js</code></a> has functions to find out instance ids for a number of servers, create and terminate instances, and get the CPU of an instance. It will become clear in a minute why these are needed.</p>
<h3 id="orchestrator">Orchestrator</h3>
<p>Next we will build our own orchestrator.</p>
<h4 id="why-orchestrate-ourselves">Why Orchestrate Ourselves?</h4>
<p>Load on our web applications is often variable.</p>
<p>Amazon AWS has its own <a href="https://aws.amazon.com/autoscaling/">Auto Scaling</a></p>
<h4 id="possible-refinements-1">Possible Refinements</h4>
<ul>
<li>Add new instance to ELB.</li>
<li>Remove old instances from the ELB (not really necessary, AWS does it already).</li>
<li>Check median instead of average.</li>
<li>Use a JSON configuration file.</li>
</ul>
<h2 id="where-to-go-from-here">Where To Go From Here</h2>
<p>The next obvious step for our DevOps infrastructure is to implement a continuous deployment system. While it may seem daunting, we are more than half-way there. All that we need to do is:</p>
<ul>
<li>get the list of servers to deploy to,</li>
<li>SSH into them and make them download the code.</li>
</ul>
<p>Combined with a tool such as <a href="http://strider-cd.github.io/">Strider CD</a>, which takes care of downloading and testing our code, we have a full continuous deployment environment!</p>
<h2 id="acknowledgements">Acknowledgements</h2>
<p>Thanks to <a href="https://www.meetup.com/es-ES/MallorcaJS/events/240203995/">MallorcaJS</a> for inviting me to give an <a href="http://slides.com/alexfernandez/build-your-owndevops-infrastructure#/">early version of this talk</a>, where I had a lot of fun. Thanks in particular to <a href="http://hotelinking.com/">hotelinking</a> and <a href="https://twitter.com/tufosa">Diego Lafuente</a> for making it possible.</p>
<p>Thanks to <span class="citation">[@lizrice]</span>(https://twitter.com/lizrice) for her talk on <a href="http://www.devopspro.ru/2016/liz_rice/">building containers from scratch</a>, which was the inspiration for this humble talk.</p>
								</div>
							</section>
							<section id="last">
								<div class="container">
									<p>
									Published on 2017-07-01. <a href="https://twitter.com/pinchito/">Comments, suggestions?</a>
									</p>
									<p>
									Back to the <a href="../index.html">index</a>.
									</p>
								</div>
							</section>

				<!-- Footer -->
					<section id="footer">
						<div class="container">
							<ul class="copyright">
								<li>&copy; <a href="mailto:alexfernandeznpm@gmail.com">Alex Fernández</a>. Distributed under the <a href="https://opensource.org/licenses/MIT">MIT license</a>.</li>
								<li>Original design: <a href="http://html5up.net">HTML5 UP</a></li>
							</ul>
						</div>
					</section>

			</div>
	</body>
</html>
