<!DOCTYPE HTML>
<!--
	Read Only by HTML5 UP
	html5up.net | @n33co
	Free for personal and commercial use under the CCA 3.0 license (html5up.net/license)

	Modified by Alex Fernández
	https://pinchito.es/ | @pinchito
-->
<html>
	<head>
		<title>The TTP Methodology</title>
		<meta charset="utf-8" />
		<meta name="description" content="The TTP Methodology — Through To Production v1" />
		<meta name="viewport" content="width=device-width, initial-scale=1" />
		<meta name="twitter:card" content="summary" />
		<meta name="twitter:site" content="@pinchito" />
		<meta name="twitter:title" content="The TTP Methodology — Through To Production v1" />
		<meta name="twitter:description" content="TTP is a simplified development methodology suitable for libraries and online systems. It keeps a single active branch with temporary feature or fix branches." />
		<meta name="twitter:image" content="https://pinchito.es/2021/pics/ttp-branches.png" />
		<link rel="stylesheet" href="/css/main.css" />
		<link rel="canonical" href="https://pinchito.es/2021/ttp" />
		<link rel="shortcut icon" href="/favicon.png" type="image/png" />
		<!--[if lte IE 8]><link rel="stylesheet" href="/css/ie8.css" /><![endif]-->
		<script>
		// Disable tracking if the opt-out cookie exists.
		var disableStr = 'ga-disable-UA-75898530-1';
		if (document.cookie.indexOf(disableStr + '=true') > -1) {
			  window[disableStr] = true;
		}
		// Opt-out function
		function gaOptout() {
			document.cookie = disableStr + '=true; expires=Thu, 31 Dec 2099 23:59:59 UTC; path=/';
			window[disableStr] = true;
		}
		(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
			(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
				m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
		})(window,document,'script','//www.google-analytics.com/analytics.js','ga');
		ga('create', 'UA-75898530-2', 'auto');
		ga('send', 'pageview');

		</script>
	</head>
	<body>

		<!-- Header -->
			<section id="header">
				<header>
					<p class="home"><a class="home" href="/">pinchito.es</a></p>
					<p>
					<a href="/about">about</a>
					<br/>
					<a href="/cv">CV</a>
					<br/>
					<a href="/speaker">speaker</a>
					</p>
					<p>
					<a id="follower" href="https://twitter.com/intent/follow?screen_name=pinchito" target="_blank"><i id="birdie"></i>@pinchito</a>
					<br/>
					<a href="https://github.com/alexfernandez" aria-label="Follow @alexfernandez on GitHub">alexfernandez @ GitHub</a>
					<br/>
					<a href="https://www.youtube.com/channel/UCp5fMWhuqcbrvSJEOByeGwg">YouTube</a>
					</p>
					<p>
					This site uses (gasp!) cookies for gathering statistics.
					You can
						<a href="javascript:gaOptout()">disable them</a>.
					</p>
				</header>
			</section>

		<!-- Wrapper -->
			<div id="wrapper">

				<!-- Main -->
					<div id="main">

						<section id="zero">
							<p class="home"><a class="home" href="/">pinchito.es</a></p>
						</section>

						<!-- One -->
							<section id="one">
								<div class="container">
									<header class="major">
										<h1>The TTP Methodology</h1>
										<p>Through To Production v1<p>
									</header>
																				<figure>
<img src="pics/ttp-branches.png" title="Example of branch organization in TTP: a single `main` branch with multiple feature or fix branches. Source: the author." alt="Create branch, add changes, review, mix, deploy, tag." /><figcaption>Create branch, add changes, review, mix, deploy, tag.</figcaption>
</figure>
<p>In this simplified methodology we keep a single active branch, which used to be <code>master</code> but is now usually called <a href="https://github.com/github/renaming"><code>main</code></a>. To add modifications:</p>
<ul>
<li>Create a branch for a fix or a feature.</li>
<li>Add changes (commits) to the branch.</li>
<li>Create a pull request or merge request.</li>
<li>Review, add changes and pass tests on the branch tip.</li>
<li>When the changes have been reviewed and all tests pass, merge the changes into the <code>main</code> branch.</li>
<li>pass all tests again on the <code>main</code> branch.</li>
<li>When this last round of testing passes, the branch is deployed to production.</li>
<li>Finally, tag the version.</li>
</ul>
<h2 id="where-does-ttp-come-from">Where Does TTP Come From?</h2>
<p>During my many years as a developer I have found many development “methodologies”. One of the most pernicious of late has been <a href="https://nvie.com/posts/a-successful-git-branching-model/">git-flow</a>, where multiple branches are kept for different versions. We will study it in more detail below.</p>
<p>I publicly propose TTPv1: Through To Production v1. It is a radical simplification valid both for online systems and for libraries. It is based on my work for the last ten years as a developer. It has been specially designed for continuous deployment. Plus, it facilitates the work of <strong>multiple teams working in parallel</strong>.</p>
<p>A first version called TPPv1 (“Todo Para Producción v1”) was published <a href="/2020/tpp">in Spanish</a> a few months ago.</p>
<h3 id="ttp-for-libraries">TTP for Libraries</h3>
<p>In libraries (<code>npm</code>, <code>maven</code> and the like) version labels are particularly important: they identify the specific version of the library which will be used.</p>
<p>We will follow <a href="https://semver.org/">Semantic Versioning</a> strictly. Versions are labeled as <code>x.y.z</code>, where:</p>
<ul>
<li><code>x</code>: major version. Break compatibility ⇒ change <code>x</code>.</li>
<li><code>y</code>: minor version. Add functionality ⇒ change <code>y</code>.</li>
<li><code>z</code>: patch version. Fix bugs ⇒ change <code>z</code>.</li>
</ul>
<p>Each version must be <strong>immutable</strong>: it is forbidden to publish two different versions under the same label.</p>
<p>If there is a failure it is trivial to roll back to the last version: just point production to the latest valid label.</p>
<p>In TTP we use <code>git</code> tags as labels: each version is first tagged in git with a version number <code>x.y.z</code>, and then the library is published with that same version number.</p>
<h3 id="ttp-for-online-systems">TTP for Online Systems</h3>
<p>In online systems we don’t really need to maintain multiple versions: it is enough to keep a single live version, which resides in the <code>main</code> branch.</p>
<p>A relevant variation in this case is to keep an additional stable branch, where code is mixed only after it has passed all of our tests. This branch can be called <code>stable</code>, <code>prod</code> or similar. In this case we will deploy to production always from the stable branch.</p>
<figure>
<img src="pics/ttp-stable.png" title="Example of organization with stable branch for online systems. Source: the author." alt="Stable branch: after mixing in main, and only when tests pass, we merge into stable and deploy from there." /><figcaption>Stable branch: after mixing in <code>main</code>, and only when tests pass, we merge into <code>stable</code> and deploy from there.</figcaption>
</figure>
<p>In this case labels or tags are less important and can even be omitted. To deploy we simply do a <code>git pull</code> in production, possibly followed by a system build and/or a process restart.</p>
<h3 id="tests-on-main-are-not-passing">Tests on <code>main</code> are not passing!</h3>
<p><strong>The <code>main</code> branch must always be deployable.</strong> If tests fail after merging the latest changes, fixing the tests will be treated with maximum priority, only slightly below a production issue. It is true that a version that does not pass all tests will not be tagged or deployed, but we will be blocking the work of other teams that want to merge and deploy.</p>
<h3 id="code-reviews">Code Reviews</h3>
<p>Code review is a crucial part of software development. I have <a href="http://alexfernandez/2018/has-anyone-else-seen-your-code">written at length about it</a>, so I will include here just a brief summary.</p>
<p>Make sure to have at least two documented review processes. The regular process should require at least two reviews from other team members. The speedy process (for emergencies and one-liners) can only require a single review. Ideally everyone from the team should participate in reviews, not only senior developers.</p>
<h2 id="comparison-with-other-development-methodologies">Comparison with Other Development Methodologies</h2>
<p>The meaning of “development methodology” changes wildly across teams: from team organization to code workflow. In this case we refer to “way to organizing and deploying changes in code”, which can also be called a development workflow.</p>
<h3 id="gitflow">GitFlow</h3>
<p>This methodology was released in 2010 and was quite successful in many organizations. It combines:</p>
<ul>
<li>feature branches for each new feature,</li>
<li>release branches (one for each version),</li>
<li>a <code>develop</code> branch for development,</li>
<li>a <code>main</code> branch for definitive versions,</li>
<li>and a <code>hotfixes</code> for urgent fixes.</li>
</ul>
<figure>
<img src="pics/ttp-gitflow.png" title="The classical GitFlow graph, with many feature branches, a few version branches, `main` and `develop` branches. Source: https://nvie.com/posts/a-successful-git-branching-model/." alt="GitFlow, or how to keep many live branches." /><figcaption>GitFlow, or how to keep many live branches.</figcaption>
</figure>
<p>The effort to keep so many branches is only feasible for large organizations with plenty of resources. The author clarifies <a href="https://nvie.com/posts/a-successful-git-branching-model/">at the top of the page</a>:</p>
<blockquote>
If your team is doing continuous delivery of software, I would suggest to adopt a much simpler workflow (like GitHub flow) instead of trying to shoehorn git-flow into your team.
</blockquote>
<h3 id="github-flow">GitHub Flow</h3>
<p>So, is GitHub Flow any better? This methodology <a href="https://docs.github.com/en/free-pro-team@latest/github/collaborating-with-issues-and-pull-requests/github-flow">proposed by GitHub</a> organizes work in a similar fashion to TTP: a branch is created, changes are added, then reviewed and merged.</p>
<figure>
<img src="pics/ttp-github-flow.png" title="Process with GitHub Flow: create branch, add changes, review, test, deploy _and then_ merge. Source: https://guides.github.com/introduction/flow/." alt="GitHub Flow: when tests pass we deploy the feature branch instead of main." /><figcaption>GitHub Flow: when tests pass we deploy the feature branch instead of <code>main</code>.</figcaption>
</figure>
<p>We can see in <a href="https://guides.github.com/introduction/flow/">the graphical guide</a> the most radical difference with TTP: with GitHub Flow <strong>deployments are done from the branch</strong>, before merging. This can cause problems since there might be changes in <code>main</code> not merged into the branch, and which therefore will not be deployed; developers must make sure to bring the latest changes from <code>main</code> to the branch (<code>git pull origin main</code>) before deploying.</p>
<p>Deploying from <code>main</code> after merging is much more robust. If you need to make sure that there is always a deployable version just use the <code>stable</code> branch.</p>
<h2 id="conclusions">Conclusions</h2>
<p>If you want to deploy code in a straightforward manner, maintain a single version and optimize team work, adopt TTP now!</p>
<h3 id="acknowledgements">Acknowledgements</h3>
<p>Thanks to my team mates at these companies: <a href="https://mediasmart.io/">mediasmart.io</a>, <a href="https://www.devo.com/">Devo</a>, <a href="https://influencity.com/">Influencity</a> and lately <a href="https://leanmind.es/">LeanMind</a> for helping me test different ways of deploying code. Thanks to my students of the <a href="/2020/curso-escalabilidad">scalability course</a> for helping me formalize the methodology.</p>
								</div>
							</section>
							<section id="last">
								<div class="container">
									<p>
									Published on 2021-01-23, modified on 2021-01-23. <a href="mailto:alexfernandeznpm@gmail.com">Comments, suggestions?</a>
									</p>
									<p>
									Back to the <a href="/">index</a>.
									</p>
								</div>
							</section>

				<!-- Footer -->
					<section id="footer">
						<div class="container">
							<ul class="copyright">
								<li>
									© <a href="mailto:alexfernandeznpm@gmail.com">Alex Fernández</a>.
									<a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a>.
								</li>
								<li>Original design: <a href="http://html5up.net">HTML5 UP</a></li>
							</ul>
						</div>
					</section>

			</div>
	</body>
</html>
